<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Neuton&family=Ubuntu+Mono">
<link rel="stylesheet"
  href="../mystyle.css">
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
</head>

<body>

<div class="topband">
  <h6>VBA</h6>
  <p>Codes for Microsoft Office Apps</p>
</div>

<!--Navigation bar-->
<div id="nav-placeholder">
</div>

<script>
$(function(){
  $("#nav-placeholder").load("../nav.html");
});
</script>
<!--end of Navigation bar-->

  
<!-- Sidebar -->
<div class="sidebar">
  <ul>
  <li><a href="#vba_colors">Colors</a></li>
    <ul>
    <li><a href="#vba_colors_rgb">RGB</a></li>
    <li><a href="#vba_colors_cmyk">CMYK</a></li>
    </ul>
  </ul>
</div>
  
<div id="vba_colors">
<h4>Colors</h4>
</div>

  
<div id="vba_colors_rgb">
<h3>RGB</h3>
</div>

<p>
  Red Green Blue (RGB) describes a color in values of 3 primary colors. It can be expressed in a decimal (DEC) or hexadecimal (HEX) number. For example, the Office Blue has RGB values of (68, 114, 196). Its DEC value will be (196*256*256 + 114*256 + 68) = 12874308. Its HEX value will be 4472C4, where 44 in HEX is 196 in DEC, and so on. By default, VBA returns color in DEC.
</p>
  
<div class = "codebox">
<pre>  
'Return font & cell color in DEC
Myfontcolor = Range("A1").Font.Color
Mycellcolor = Range("A1").Interior.Color

'Convert color from DEC to HEX
Mycolor_hex = Hex(Mycolor)

'Convert color from DEC to RGB
Mycolor_r = Mycolor Mod 256
Mycolor_g = (Mycolor / 256) Mod 256
Mycolor_b = (Mycolor / 256 / 256) Mod 256
</pre>
</div>

<hr>
  
<div id="vba_colors_CMYK">
<h3>CMYK</h3>
</div>

<p>
  Opposite to RGB, Cyan Magenta Yellow Key (CMYK) describes a color by a combination of light absorption. K is the minimum blackness of the RGB values. After adjustment for K, the complementary RGB values become the respective CMY values. For example, the Office Blue has RGB values of (68, 114, 196). Its CMYK values will be (0.65, 0.42, 0, 0.23), where K = 1 - 196/255 = 0.23; C = 1- 68/196 = 0.65, and so on. CMYK makes more intuitive sense as it resembles the process of color paint mixing. 
</p>
  
<div class = "codebox">
<pre>  
'Convert color from RGB to CMYK
Mycolor_maxrgb = Max(Mycolor_r, Mycolor_g, Mycolor_b)
Mycolor_k = 1 - Mycolor_maxrgb / 255
Mycolor_c = 1 - Mycolor_r / Mycolor_maxrgb
Mycolor_m = 1 - Mycolor_g / Mycolor_maxrgb
Mycolor_y = 1 - Mycolor_b / Mycolor_maxrgb

'Convert color from CMYK to RGB 
Mycolor_maxrgb = 255 * (1 - Mycolor_k)
Mycolor_r = (1 - Mycolor_c) * Mycolor_maxrgb
Mycolor_g = (1 - Mycolor_m) * Mycolor_maxrgb
Mycolor_b = (1 - Mycolor_y) * Mycolor_maxrgb
</pre>
</div>

 
</body>
</html>
